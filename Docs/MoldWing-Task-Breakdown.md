# MoldWing 任务拆分（Qt 方案）

> **版本**: 4.0
> **创建日期**: 2025-12-26
> **最后更新**: 2025-12-30
> **拆分层次**: Epic (里程碑) → Story (功能模块) → Task (具体任务)

---

## 当前进度概览

| 里程碑 | 状态 | 进度 |
|-------|------|------|
| M1 基础框架 | ✅ 完成 | 100% |
| M2 框选 | ✅ 完成 | 100% |
| M3 刷选 | ✅ 完成 | 100% |
| M4 套索选择 | ✅ 完成 | 100% |
| M5 连通选择 | ✅ 完成 | 100% |
| M6 纹理渲染+编辑框架 | ✅ 完成 | 100% |
| M7 克隆图章 | ✅ 完成 | 100% |
| M7.5 OBJ带纹理导出 | ✅ 完成 | 100% |
| M8 图层树与多模型管理 | ✅ 完成 | 100% |
| M9 选择性导出 | ✅ 完成 | 100% |
| M10 OSGB标准瓦片导出 | ✅ 完成 | 100% |
| M11 橡皮擦 | ⏳ 待开始 | 0% |
| M12 颜色调整 | ⏳ 待开始 | 0% |
| M13 几何修复 | ⏳ 待开始 | 0% |

**状态说明**: ✅ 已完成 | 🔄 进行中 | ⏳ 待开始

---

## 技术栈

| 组件 | 技术 |
|-----|------|
| UI框架 | **Qt 6 Widgets** |
| 渲染引擎 | DiligentEngine |
| 几何处理 | CGAL + Eigen3 |
| 模型加载 | assimp |
| 日志系统 | **spdlog** |

---

## 任务依赖关系图

```
M1 基础框架 ──┬──> M2 框选 ──> M3 刷选 ──> M4 套索 ──> M5 连通
(Qt+Diligent) │
              ├──> M6 纹理渲染+编辑框架 ──┬──> M7 克隆图章 ──> M7.5 OBJ导出
              │                          └──> M11 橡皮擦
              │                               └──> M12 颜色调整
              │
              ├──> M8 图层树与多模型管理 ──> M9 选择性导出 ──> M10 OSGB导出
              │
              └──> M13 几何修复
```

### 纹理编辑技术方案

**屏幕空间投影编辑**（区别于传统UV展开方案）：
- 用户在3D视图直接操作，编辑模式下锁定视角
- 系统将屏幕坐标映射到纹理坐标
- 实际编辑在纹理空间进行（保持原生分辨率）
- 共享纹理区域自动同步更新
- 多角度编辑：退出→旋转→重新进入

---

## M1: 基础框架（Qt + DiligentEngine） ✅ 100%

### S1.1 项目骨架搭建 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.1.1 | 创建 Apps/MoldWing/ 目录结构 | 0.5h | - | ✅ |
| T1.1.2 | 编写 CMakeLists.txt（Qt6 + DiligentEngine） | 1.5h | T1.1.1 | ✅ |
| T1.1.3 | 更新 vcpkg.json 添加依赖 | 0.5h | - | ✅ |
| T1.1.4 | 创建 main.cpp（QApplication 入口） | 0.5h | T1.1.2 | ✅ |
| T1.1.5 | 验证 Qt 窗口显示 | 0.5h | T1.1.4 | ✅ |

### S1.2 Qt + DiligentEngine 集成 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.2.1 | 创建 DiligentWidget 类（QWidget子类） | 1h | S1.1 | ✅ |
| T1.2.2 | 获取 Qt 窗口原生句柄 (winId) | 0.5h | T1.2.1 | ✅ |
| T1.2.3 | 初始化 DiligentEngine Device/Context | 2h | T1.2.2 | ✅ |
| T1.2.4 | 创建 SwapChain 绑定到 Qt 窗口 | 1h | T1.2.3 | ✅ |
| T1.2.5 | 实现 paintEvent 触发渲染 | 1h | T1.2.4 | ✅ |
| T1.2.6 | 实现 resizeEvent 处理窗口大小变化 | 0.5h | T1.2.5 | ✅ |
| T1.2.7 | 验证基础渲染（清屏颜色） | 0.5h | T1.2.6 | ✅ |

### S1.3 网格数据结构 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.3.1 | 定义 Vertex 结构体（position, normal, texcoord） | 0.5h | S1.1 | ✅ |
| T1.3.2 | 定义 MeshData 结构体（vertices, indices） | 0.5h | T1.3.1 | ✅ |
| T1.3.3 | 定义 TextureData 结构体（使用 QImage） | 0.5h | T1.3.1 | ✅ |
| T1.3.4 | 实现邻接表构建 | 1h | T1.3.2 | ✅ |

### S1.4 模型加载（assimp） ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.4.1 | 集成 assimp 库 | 0.5h | S1.1 | ✅ |
| T1.4.2 | 实现 MeshLoader::loadOBJ() | 2h | T1.4.1, S1.3 | ✅ |
| T1.4.3 | 加载纹理（QImage / stb_image） | 1h | T1.4.2 | ⏳ (M6) |
| T1.4.4 | 测试加载示例 OBJ 模型 | 0.5h | T1.4.3 | ✅ |

### S1.5 网格渲染 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.5.1 | 创建顶点缓冲和索引缓冲 | 1h | S1.4, S1.2 | ✅ |
| T1.5.2 | 编写顶点着色器（MVP变换） | 1h | T1.5.1 | ✅ |
| T1.5.3 | 编写片段着色器（Blinn-Phong光照） | 1h | T1.5.2 | ✅ |
| T1.5.4 | 创建图形管线 PSO | 1h | T1.5.3 | ✅ |
| T1.5.5 | 实现 MeshRenderer::render() | 1h | T1.5.4 | ✅ |
| T1.5.6 | 添加纹理采样支持 | 1h | T1.5.5 | ⏳ (M6) |

### S1.6 相机系统（增强版） ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.6.1 | 实现 OrbitCamera 基础类 | 1h | S1.2 | ✅ |
| T1.6.2 | 重写 mousePressEvent（开始拖拽） | 0.5h | T1.6.1 | ✅ |
| T1.6.3 | 重写 mouseMoveEvent（旋转/平移） | 1h | T1.6.2 | ✅ |
| T1.6.4 | 重写 wheelEvent（缩放） | 0.5h | T1.6.1 | ✅ |
| T1.6.5 | 实现 fitToModel()（自动适配） | 0.5h | T1.6.4 | ✅ |
| T1.6.6 | 创建 CameraSettings 配置结构 | 0.5h | T1.6.1 | ✅ |
| T1.6.7 | 实现平滑插值系统 | 1h | T1.6.6 | ✅ |
| T1.6.8 | 实现惯性系统（鼠标释放后动量） | 1h | T1.6.7 | ✅ |
| T1.6.9 | 实现缩放到光标功能 | 0.5h | T1.6.4 | ✅ |
| T1.6.10 | 添加视图预设（Front/Back/Top/Bottom/Left/Right/Iso） | 1h | T1.6.1 | ✅ |
| T1.6.11 | 实现视图切换动画 | 1h | T1.6.10 | ✅ |
| T1.6.12 | Blender风格鼠标控制（MMB旋转/Shift+MMB平移） | 1h | T1.6.3 | ✅ |
| T1.6.13 | 实现Numpad快捷键（1/3/7/0/5） | 0.5h | T1.6.10 | ✅ |
| T1.6.14 | 实现约束旋转（Ctrl吸附45度） | 0.5h | T1.6.3 | ✅ |
| T1.6.15 | 添加右键上下文菜单 | 0.5h | T1.6.10 | ✅ |
| T1.6.16 | 正交/透视投影切换 | 0.5h | T1.6.1 | ✅ |

### S1.7 撤销/重做系统（QUndoStack） ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.7.1 | 创建 QUndoStack | 0.5h | S1.1 | ✅ |
| T1.7.2 | 创建 QUndoView 显示历史 | 0.5h | T1.7.1 | ✅ |
| T1.7.3 | 配置 Ctrl+Z / Ctrl+Y 快捷键 | 0.5h | T1.7.1 | ✅ |

### S1.8 Qt 主窗口布局 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.8.1 | 创建 MainWindow 类（QMainWindow） | 1h | S1.2 | ✅ |
| T1.8.2 | 设置 DiligentWidget 为中央窗口 | 0.5h | T1.8.1 | ✅ |
| T1.8.3 | 创建左侧工具 QDockWidget | 1h | T1.8.1 | ✅ |
| T1.8.4 | 创建右侧属性 QDockWidget | 1h | T1.8.1 | ✅ |
| T1.8.5 | 创建历史记录 QDockWidget（tabify） | 0.5h | T1.8.4 | ✅ |
| T1.8.6 | 创建菜单栏（文件/编辑/视图） | 1h | T1.8.1 | ✅ |
| T1.8.7 | 创建工具栏 | 1h | T1.8.1 | ✅ |
| T1.8.8 | 创建状态栏 | 0.5h | T1.8.1 | ✅ |
| T1.8.9 | 实现 saveState/restoreState 布局保存 | 0.5h | T1.8.5 | ✅ |

### S1.9 日志系统（spdlog） ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T1.9.1 | 添加 spdlog 依赖到 vcpkg.json | 0.2h | S1.1 | ✅ |
| T1.9.2 | 创建 Logger 单例类 | 1h | T1.9.1 | ✅ |
| T1.9.3 | 配置日志输出到 exe 同级 logs/ 目录 | 0.5h | T1.9.2 | ✅ |
| T1.9.4 | 实现日志文件命名（日期+进程ID） | 0.5h | T1.9.3 | ✅ |
| T1.9.5 | 实现启动时清理上次日志 | 0.5h | T1.9.4 | ✅ |
| T1.9.6 | 集成 Windows MiniDump 崩溃捕获 | 1.5h | T1.9.2 | ✅ |
| T1.9.7 | 崩溃时自动保存日志和 .dmp 文件 | 1h | T1.9.6 | ✅ |
| T1.9.8 | 定义日志宏（MW_LOG_INFO/WARN/ERROR等） | 0.5h | T1.9.2 | ✅ |
| T1.9.9 | 在 main.cpp 初始化日志系统 | 0.3h | T1.9.8 | ✅ |

**M1 总计: ~44h（已完成）**

> 注意: T1.4.3 和 T1.5.6 (纹理相关) 推迟到 M6 纹理视图里程碑
>
> **2025-12-27 更新**: S1.6 相机系统增强，添加了平滑插值、惯性、视图预设、Blender风格控制等专业功能

---

## M2: 框选 ✅ 100%

### S2.1 GPU 拾取系统 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T2.1.1 | 创建 ID 渲染目标（R32_UINT格式） | 1h | M1 | ✅ |
| T2.1.2 | 编写 ID 渲染着色器 | 1h | T2.1.1 | ✅ |
| T2.1.3 | 实现 renderIDBuffer() | 1h | T2.1.2 | ✅ |
| T2.1.4 | 实现 readFaceID(screenPos) | 1h | T2.1.3 | ✅ |
| T2.1.5 | 实现 readFaceIDsInRect() | 1h | T2.1.4 | ✅ |

### S2.2 选择系统核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T2.2.1 | 创建 SelectionSystem 类（QObject） | 0.5h | S2.1 | ✅ |
| T2.2.2 | 实现 selectedFaces 集合管理 | 0.5h | T2.2.1 | ✅ |
| T2.2.3 | 定义 selectionChanged 信号 | 0.2h | T2.2.1 | ✅ |
| T2.2.4 | 实现 invertSelection() | 0.5h | T2.2.2 | ✅ |
| T2.2.5 | 实现 clearSelection() | 0.2h | T2.2.2 | ✅ |
| T2.2.6 | 实现 selectAll() | 0.2h | T2.2.2 | ✅ |
| T2.2.7 | 创建 SelectFacesCommand（QUndoCommand） | 1h | T2.2.2 | ✅ |

### S2.3 框选实现 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T2.3.1 | 处理 mousePressEvent 开始框选 | 0.5h | S2.2 | ✅ |
| T2.3.2 | 处理 mouseMoveEvent 更新框选 | 0.5h | T2.3.1 | ✅ |
| T2.3.3 | 使用 QRubberBand 绘制框选矩形 | 1h | T2.3.2 | ✅ |
| T2.3.4 | 处理 mouseReleaseEvent 完成框选 | 1h | T2.3.3 | ✅ |
| T2.3.5 | 支持 Ctrl 增选 / Shift 减选 | 0.5h | T2.3.4 | ✅ |

### S2.4 选择可视化 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T2.4.1 | 创建选中面高亮着色器 | 1h | S2.3 | ✅ |
| T2.4.2 | 实现 SelectionRenderer 类 | 1h | T2.4.1 | ✅ |
| T2.4.3 | 支持选中面半透明叠加 | 0.5h | T2.4.2 | ✅ |

**M2 总计: ~14h（已完成）**

> **2025-12-27 更新**: M2 框选功能完成
> - FacePicker: GPU 拾取系统，使用 SV_PrimitiveID 渲染面 ID 到离屏缓冲
> - SelectionSystem: 选择管理，支持 Qt 信号和 QUndoCommand
> - SelectionRenderer: 选中面高亮渲染（半透明叠加 + DepthBias 解决 z-fighting）
> - SelectionBoxRenderer: DiligentEngine 渲染框选矩形（替代 Qt 叠加层，解决合成问题）
> - 支持 Ctrl 增选、Shift 减选

---

## M3: 刷选 ✅ 100%

### S3.1 刷选核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T3.1.1 | 添加 SelectMode::Brush 模式 | 0.5h | M2 | ✅ |
| T3.1.2 | 实现 brushRadius 属性 | 0.2h | T3.1.1 | ✅ |
| T3.1.3 | 实现 updateBrushSelect() | 1h | T3.1.2 | ✅ |
| T3.1.4 | 使用 BrushCursorRenderer 绘制刷选圆形光标 | 1h | T3.1.3 | ✅ |
| T3.1.5 | 支持 [ ] 快捷键调整笔刷大小 | 0.5h | T3.1.4 | ✅ |

### S3.2 刷选优化 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T3.2.1 | 优化：仅检测笔刷范围内的面 (readFaceIDsInCircle) | 1h | S3.1 | ✅ |
| T3.2.2 | 支持持续拖拽选择 | 0.5h | T3.2.1 | ✅ |
| T3.2.3 | 属性面板：笔刷大小滑块 (QSlider + QSpinBox) | 0.5h | T3.2.2 | ✅ |

**M3 总计: ~5h（已完成）**

> **2025-12-27 更新**: M3 刷选功能完成
> - BrushCursorRenderer: DiligentEngine 渲染圆形笔刷光标（NDC 空间 2D 叠加）
> - FacePicker::readFaceIDsInCircle: 圆形区域内的面 ID 批量读取
> - DiligentWidget: 刷选状态管理、连续拖拽选择、快捷键支持
> - MainWindow: 属性面板笔刷大小滑块（与键盘快捷键双向同步）
> - 使用 PRIMITIVE_TOPOLOGY_TRIANGLE_LIST 绘制圆形（DiligentEngine 不支持 TRIANGLE_FAN）

---

## M4: 套索选择 ✅ 100%

### S4.1 套索核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T4.1.1 | 添加 SelectMode::Lasso 模式 | 0.5h | M3 | ✅ |
| T4.1.2 | 使用 QPolygonF 记录鼠标轨迹 | 0.5h | T4.1.1 | ✅ |
| T4.1.3 | 使用 LassoRenderer 绘制套索轨迹 | 1h | T4.1.2 | ✅ |
| T4.1.4 | 实现多边形闭合检测 | 0.5h | T4.1.3 | ✅ |

### S4.2 点在多边形内判断 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T4.2.1 | 使用 QPolygonF::containsPoint() | 0.5h | S4.1 | ✅ |
| T4.2.2 | 实现 endLassoSelect() | 1h | T4.2.1 | ✅ |
| T4.2.3 | 优化：采样点简化 | 0.5h | T4.2.2 | ✅ |

**M4 总计: ~5h（已完成）**

> **2025-12-27 更新**: M4 套索选择功能完成
> - LassoRenderer: DiligentEngine 渲染套索路径（NDC 空间 2D 叠加，仅边框线）
> - QPolygonF: 记录鼠标轨迹，使用 containsPoint() 判断面中心是否在套索内
> - OrbitCamera::worldToScreen: 新增将世界坐标投影到屏幕空间的方法
> - DiligentWidget: 套索状态管理（begin/update/endLassoSelect）
> - 支持 Ctrl 增选、Shift 减选
> - 采样点简化：LassoRenderer::addPoint 中实现最小距离过滤
> - 修复套索显示闪烁问题（移除非凸多边形填充渲染）

---

## M5: 连通选择 ✅ 100%

### S5.1 邻接关系 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T5.1.1 | 构建面-面邻接表 | 1h | M4 | ✅ |
| T5.1.2 | 缓存邻接关系 | 0.5h | T5.1.1 | ✅ |

### S5.2 连通选择 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T5.2.1 | 添加 SelectMode::Link 模式 | 0.5h | S5.1 | ✅ |
| T5.2.2 | 实现 selectLinked() BFS | 1h | T5.2.1 | ✅ |
| T5.2.3 | 实现 selectByAngle() 角度限制 | 1h | T5.2.2 | ✅ |
| T5.2.4 | 属性面板：角度阈值滑块 | 0.5h | T5.2.3 | ✅ |

### S5.3 选择扩展/收缩 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T5.3.1 | 实现 growSelection() | 0.5h | S5.2 | ✅ |
| T5.3.2 | 实现 shrinkSelection() | 0.5h | T5.3.1 | ✅ |

**M5 总计: ~6h（已完成）**

> **2025-12-27 更新**: M5 连通选择功能完成
> - MeshData::buildAdjacency: 基于共享边构建面-面邻接表
> - MeshData::computeFaceNormals: 计算面法向量用于角度判断
> - SelectionSystem::selectLinked: BFS 算法选择所有连通面
> - SelectionSystem::selectByAngle: 基于法向量夹角限制的连通选择
> - SelectionSystem::growSelection: 扩展选择到相邻面
> - SelectionSystem::shrinkSelection: 移除边界面收缩选择
> - 属性面板角度阈值滑块（0°=共面，180°=全连通）
> - 菜单项：Ctrl++ 扩展选择，Ctrl+- 收缩选择

---

## M6: 纹理渲染 + 编辑模式框架 ✅ 100%

### S6.1 纹理渲染基础 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T6.1.1 | 创建 Material 数据结构（diffuseTexPath, textureId） | 0.5h | M5 | ✅ |
| T6.1.2 | 创建 TextureLoader（stb_image 加载 PNG/JPG/TGA） | 1h | T6.1.1 | ✅ |
| T6.1.3 | MeshData 扩展（materials 列表、Face.materialId） | 0.5h | T6.1.1 | ✅ |
| T6.1.4 | MeshLoader 扩展（读取 MTL 材质文件、加载纹理） | 2h | T6.1.2, T6.1.3 | ✅ |
| T6.1.5 | 创建 GPU 纹理（ITexture）和采样器（ISampler） | 1h | T6.1.4 | ✅ |
| T6.1.6 | 修改 MeshRenderer 着色器支持纹理采样 | 1h | T6.1.5 | ✅ |
| T6.1.7 | 绑定纹理 SRV 到 PSO | 1h | T6.1.6 | ✅ |
| T6.1.8 | 验证带纹理模型渲染 | 0.5h | T6.1.7 | ✅ |

### S6.2 屏幕-纹理映射系统 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T6.2.1 | FacePicker 扩展 pickPoint(x,y) 返回 {faceId, depth} | 1h | S6.1 | ✅ |
| T6.2.2 | 实现 BarycentricCalculator（屏幕坐标→重心坐标） | 1.5h | T6.2.1 | ✅ |
| T6.2.3 | 实现 UVInterpolator（重心坐标→精确UV坐标） | 1h | T6.2.2 | ✅ |
| T6.2.4 | 创建 ScreenToTextureMapper 类 | 0.5h | T6.2.3 | ✅ |
| T6.2.5 | 实现可见面映射表预计算和缓存 | 1.5h | T6.2.4 | ✅ |
| T6.2.6 | 单元测试：屏幕坐标→纹理坐标转换 | 1h | T6.2.5 | ✅ |

### S6.3 编辑模式框架 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T6.3.1 | 创建 TextureEditMode 类（编辑状态管理） | 1h | S6.2 | ✅ |
| T6.3.2 | 实现 enterEditMode() / exitEditMode() | 0.5h | T6.3.1 | ✅ |
| T6.3.3 | 实现视角锁定（禁止旋转/平移/缩放） | 0.5h | T6.3.2 | ✅ |
| T6.3.4 | 状态栏提示 "编辑模式 - 视角已锁定" | 0.3h | T6.3.3 | ✅ |
| T6.3.5 | 创建 TextureEditBuffer（CPU 纹理副本） | 1h | T6.3.1 | ✅ |
| T6.3.6 | 实现脏区域跟踪（dirty regions） | 1h | T6.3.5 | ✅ |
| T6.3.7 | 实现 GPU 纹理同步（脏区域更新） | 1h | T6.3.6 | ✅ |
| T6.3.8 | 实现 ScreenCapture（工具激活时截取屏幕） | 1h | T6.3.1 | ✅ |
| T6.3.9 | 创建 TextureEditCommand（QUndoCommand） | 1h | T6.3.5 | ✅ |
| T6.3.10 | 实现每笔撤销（记录像素变更） | 1h | T6.3.9 | ✅ |
| T6.3.11 | 实现 saveTexture() 手动保存功能 | 1h | T6.3.5 | ✅ |
| T6.3.12 | 编辑工具基类 TextureEditTool | 0.5h | T6.3.1 | ✅ |

**M6 总计: ~22h（已完成）**

> **2025-12-30 更新**: M6 纹理渲染+编辑模式框架完成
> - Material/TextureData: 材质和纹理数据结构
> - MeshLoader: 读取 MTL 材质文件，加载纹理
> - MeshRenderer: GPU 纹理创建、采样器、着色器采样
> - ScreenToTextureMapper: Moller-Trumbore 射线求交，重心坐标 UV 插值
> - TextureEditMode: 编辑模式状态管理，视角锁定
> - TextureEditBuffer: CPU 纹理副本，脏区域跟踪
> - TextureEditCommand: QUndoCommand 撤销支持

---

## M7: 克隆图章工具 ✅ 100%

### S7.1 克隆图章核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.1.1 | 创建 CloneStampTool 类（继承 TextureEditTool） | 0.5h | M6 | ✅ |
| T7.1.2 | 实现 setCloneSource()（Alt+点击设置源点） | 1h | T7.1.1 | ✅ |
| T7.1.3 | 屏幕坐标→纹理坐标转换（源点） | 0.5h | T7.1.2 | ✅ |
| T7.1.4 | 实现克隆绘制（拖拽时复制像素） | 2h | T7.1.3 | ✅ |
| T7.1.5 | 纹理空间像素采样和写入 | 1h | T7.1.4 | ✅ |
| T7.1.6 | 显示克隆源点标记（十字标记） | 0.5h | T7.1.2 | ✅ |

### S7.2 克隆图章优化 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.2.1 | 实现笔刷大小调节 | 0.5h | S7.1 | ✅ |
| T7.2.2 | 实现笔刷硬度（边缘羽化） | 1h | T7.2.1 | ✅ |
| T7.2.3 | 实现笔画插值（连续绘制） | 1h | T7.2.2 | ✅ |
| T7.2.4 | 属性面板：笔刷大小/硬度滑块 | 0.5h | T7.2.3 | ✅ |
| T7.2.5 | 快捷键 S 激活克隆图章 | 0.2h | T7.2.4 | ✅ |

**M7 总计: ~9h（已完成）**

> **2025-12-30 更新**: M7 克隆图章工具完成
> - DiligentWidget: TextureEdit 交互模式，Alt+点击设置克隆源
> - ScreenToTextureMapper: 屏幕坐标到纹理坐标映射
> - paintBrushAtPosition: 克隆像素绘制（源偏移计算）
> - TextureEditCommand: 记录像素变更，支持撤销/重做
> - MeshRenderer::updateTextureFromBuffer: GPU 纹理实时更新
> - MainWindow: Texture 菜单（进入/退出编辑模式、保存纹理）

---

## M7.5: OBJ 带纹理导出 ✅ 100%

> **新增里程碑**: 在完成纹理编辑后，将模型和编辑后的纹理导出为新的 OBJ 文件

### 功能需求
- 导出完整模型为 OBJ 文件（顶点、法向量、UV、面）
- 生成配套的 MTL 材质文件
- **导出编辑后的纹理**（保持原格式 PNG/JPG/TGA）
- 纹理与 OBJ 同目录，MTL 使用相对路径
- 用户通过 QFileDialog 指定保存位置

### S7.5.1 MeshExporter 核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.5.1.1 | 创建 MeshExporter 类（IO/MeshExporter.hpp/cpp） | 0.5h | M7 | ✅ |
| T7.5.1.2 | 实现 OBJ 顶点写入（v x y z） | 0.5h | T7.5.1.1 | ✅ |
| T7.5.1.3 | 实现 OBJ 法向量写入（vn nx ny nz） | 0.5h | T7.5.1.2 | ✅ |
| T7.5.1.4 | 实现 OBJ 纹理坐标写入（vt u v） | 0.5h | T7.5.1.3 | ✅ |
| T7.5.1.5 | 实现 OBJ 面索引写入（f v/vt/vn） | 1h | T7.5.1.4 | ✅ |
| T7.5.1.6 | 生成 mtllib 引用行 | 0.2h | T7.5.1.5 | ✅ |

### S7.5.2 MTL 材质导出 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.5.2.1 | 实现 MTL 文件生成（newmtl, Ka, Kd, Ks） | 0.5h | S7.5.1 | ✅ |
| T7.5.2.2 | 写入 map_Kd 纹理相对路径 | 0.3h | T7.5.2.1 | ✅ |

### S7.5.3 纹理导出 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.5.3.1 | 获取编辑后纹理数据（TextureEditBuffer::getData） | 0.5h | S7.5.2 | ✅ |
| T7.5.3.2 | 保持原格式导出（QImage::save 或 stb_image_write） | 1h | T7.5.3.1 | ✅ |
| T7.5.3.3 | 处理多材质多纹理情况 | 0.5h | T7.5.3.2 | ✅ |

### S7.5.4 UI 集成 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T7.5.4.1 | 添加 File → Export As... 菜单项（Ctrl+Shift+S） | 0.3h | S7.5.3 | ✅ |
| T7.5.4.2 | 实现 QFileDialog 保存对话框（OBJ 过滤器） | 0.5h | T7.5.4.1 | ✅ |
| T7.5.4.3 | 状态栏提示导出结果 | 0.2h | T7.5.4.2 | ✅ |

**M7.5 总计: ~7h（已完成）**

### 技术要点

**OBJ 文件格式**:
```obj
# MoldWing Export
mtllib model.mtl

v 1.0 2.0 3.0
vn 0.0 1.0 0.0
vt 0.5 0.5

usemtl material_0
f 1/1/1 2/2/2 3/3/3
```

**MTL 文件格式**:
```mtl
newmtl material_0
Ka 0.2 0.2 0.2
Kd 0.8 0.8 0.8
Ks 0.0 0.0 0.0
map_Kd texture_0.png
```

**纹理导出策略**:
- 如果纹理被编辑过：从 TextureEditBuffer 获取数据
- 如果纹理未编辑：直接复制原纹理文件
- 保持原格式（PNG/JPG/TGA）避免质量损失

---

## M8: 图层树与多模型管理 ✅ 100%

> **新增里程碑**: 支持多个 OBJ 文件同时加载和管理，采用增量式验收方法

### 增量式验收计划

| 步骤 | 功能 | 可视化验收标准 | 状态 |
|-----|------|---------------|------|
| 1.1 | 图层树 Dock 面板 | 左侧出现空的"图层"面板 | ✅ |
| 1.2 | 单 OBJ 显示在图层树 | 加载模型后树中显示文件名 | ✅ |
| 1.3 | 多 OBJ 追加导入 | 多次打开文件，追加到图层树 | ✅ |
| 1.4 | 异步加载 + 进度动画 | 加载时进度条动画正常显示 | ✅ |
| 1.5 | 图层显示/隐藏 | 点击眼睛图标，模型消失/出现 | ✅ |
| 1.6 | 图层选择高亮 | 点击图层项，对应模型边框高亮 | ✅ |
| 1.7 | 修改状态标记 | 编辑纹理后，图层名旁显示 * 号 | ✅ |
| 1.8 | 文件夹批量导入 | File→Import Folder (Ctrl+Shift+O) | ✅ |

### S8.1 图层树 UI ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.1.1 | 创建图层树 Dock 面板（QDockWidget） | 0.5h | M7.5 | ✅ |
| T8.1.2 | 添加 QTreeWidget 作为图层树控件 | 0.5h | T8.1.1 | ✅ |
| T8.1.3 | 定义 LayerItem 数据结构（模型引用、状态） | 0.5h | T8.1.2 | ✅ |
| T8.1.4 | 单个 OBJ 显示在图层树中 | 1h | T8.1.3 | ✅ |
| T8.1.5 | 图层项自定义渲染（图标 + 名称 + 状态） | 1h | T8.1.4 | ✅ |

### S8.1.5 异步加载 ✅ (新增)
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.1.5.1 | 添加 Qt6::Concurrent 依赖 | 0.5h | S8.1 | ✅ |
| T8.1.5.2 | 使用 QtConcurrent::run() 后台加载 | 1h | T8.1.5.1 | ✅ |
| T8.1.5.3 | QFutureWatcher 监控加载完成 | 0.5h | T8.1.5.2 | ✅ |
| T8.1.5.4 | 进度对话框动画正常显示 | 0.5h | T8.1.5.3 | ✅ |

### S8.2 图层显示控制 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.2.1 | 添加显示/隐藏按钮（眼睛图标） | 0.5h | S8.1 | ✅ |
| T8.2.2 | 实现模型显示/隐藏逻辑 | 1h | T8.2.1 | ✅ |
| T8.2.3 | 图层选择高亮（边框效果） | 1h | T8.2.2 | ✅ |

### S8.3 多模型加载 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.3.1 | 创建 SceneManager 类管理多模型 | 1.5h | S8.1 | ✅ |
| T8.3.2 | 修改 MeshLoader 返回模型列表 | 1h | T8.3.1 | ✅ |
| T8.3.3 | File→Import Multiple 菜单项 | 0.5h | T8.3.2 | ✅ |
| T8.3.4 | 批量选择多个 OBJ 文件 | 0.5h | T8.3.3 | ✅ |
| T8.3.5 | 文件夹批量导入（递归扫描 *.obj） | 1h | T8.3.4 | ✅ |

### S8.4 多模型渲染 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.4.1 | MeshRenderer 支持多模型渲染 | 1.5h | S8.3 | ✅ |
| T8.4.2 | 每个模型独立的变换矩阵 | 1h | T8.4.1 | ✅ |
| T8.4.3 | 可见性过滤（只渲染可见模型） | 0.5h | T8.4.2 | ✅ |

### S8.5 修改状态追踪 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.5.1 | 模型添加 isDirty 标志 | 0.5h | S8.4 | ✅ |
| T8.5.2 | 纹理编辑时标记 dirty | 0.5h | T8.5.1 | ✅ |
| T8.5.3 | 图层树显示 * 号标记 | 0.5h | T8.5.2 | ✅ |

### S8.6 多模型选择系统（方案B：复合面ID）✅
> 采用复合面ID（高8位=meshId, 低24位=faceId）实现跨模型统一选择

| 步骤 | 功能 | 可视化验收标准 | 状态 |
|------|------|---------------|------|
| B1 | CompositeId 工具类 | 编译时 static_assert 通过 | ✅ |
| B2 | 多模型面拾取 | Alt+点击显示正确的 Mesh:Face | ✅ |
| B3 | 跨模型框选 | 框选多模型都被选中 | ✅ |
| B4 | 跨模型选择渲染 | 多模型高亮显示 | ✅ |
| B5 | 多纹理编辑缓冲区 | 跨模型克隆生效 | ✅ |
| B6 | 模型选择导出 | 勾选导出正确 | ✅ |

| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T8.6.1 | CompositeId 工具类（编码/解码/验证） | 1h | S8.4 | ✅ |
| T8.6.2 | FacePicker 多模型渲染（复合ID输出） | 2h | T8.6.1 | ✅ |
| T8.6.3 | SelectionSystem 使用 CompositeId | 1.5h | T8.6.2 | ✅ |
| T8.6.4 | SelectionRenderer 多模型高亮 | 1.5h | T8.6.3 | ✅ |
| T8.6.5 | 多纹理编辑缓冲区管理 | 2h | T8.6.4 | ✅ |
| T8.6.6 | 模型选择导出功能 | 1h | T8.6.5 | ✅ |

**M8 总计: ~23h（已完成）**

> **2025-12-31 更新**: M8 图层树与多模型管理完成
> - MeshInstance 架构：每个模型持有独立的 editBuffers
> - CompositeId：高8位=meshId, 低24位=faceId 编码
> - 跨模型选择：框选/刷选/套索/连通都支持多模型
> - ExportDialog：模型选择导出对话框
> - 文件夹批量导入：递归扫描 *.obj 文件

---

## M9: 选择性导出 ✅ 100%

> **功能目标**: 导出时选择要导出的 OBJ（已在 M8 B6 中实现）

### 增量式验收计划

| 步骤 | 功能 | 可视化验收标准 | 状态 |
|-----|------|---------------|------|
| 2.1 | 导出对话框带勾选列表 | Export 时弹出模型列表 | ✅ |
| 2.2 | 勾选/全选/反选 | 复选框交互正常 | ✅ |
| 2.3 | 批量 OBJ 导出 | 导出多个 OBJ 到指定目录 | ✅ |

### S9.1 导出对话框 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T9.1.1 | 创建 ExportDialog 类（QDialog） | 1h | M8 | ✅ |
| T9.1.2 | 添加模型列表（QListWidget + QCheckBox） | 1h | T9.1.1 | ✅ |
| T9.1.3 | 全选/反选/取消按钮 | 0.5h | T9.1.2 | ✅ |
| T9.1.4 | 输出目录选择 | 0.5h | T9.1.3 | ✅ |

### S9.2 批量导出 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T9.2.1 | MeshExporter 支持批量导出 | 1h | S9.1 | ✅ |
| T9.2.2 | 进度显示（QProgressDialog） | 0.5h | T9.2.1 | ✅ |
| T9.2.3 | 导出结果汇总 | 0.5h | T9.2.2 | ✅ |

**M9 总计: ~5h（已完成）**

> **2025-12-31 更新**: M9 选择性导出功能在 M8 B6 中实现
> - ExportDialog：模型勾选列表 + 面数显示
> - 全选/取消全选按钮
> - 输出目录选择
> - 异步批量导出 + 进度显示

---

## M10: OSGB 标准瓦片导出 ✅ 100%

> **功能目标**: 将 OBJ 导出为标准倾斜摄影瓦片目录结构，支持 LOD 和地理坐标系

### 增量式验收计划

| 步骤 | 功能 | 可视化验收标准 | 状态 |
|-----|------|---------------|------|
| 3.1 | OSGB 导出菜单项 | File→Export OSGB (Ctrl+Shift+G) | ✅ |
| 3.2 | 单个 OBJ→OSGB | 生成 Data/tile_xxx/tile_xxx.osgb | ✅ |
| 3.3 | LOD 自动生成 | 生成 _L17_0, _L18_0 等 LOD 文件 | ✅ |
| 3.4 | 坐标系转换 | 支持 EPSG 坐标系选择和转换 | ✅ |
| 3.5 | 批量 OSGB 导出 | 多个 OBJ 各自生成瓦片目录 | ✅ |

### S10.1 依赖配置 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.1.1 | vcpkg 添加 osg 依赖 | 0.5h | M9 | ✅ |
| T10.1.2 | vcpkg 添加 proj 依赖 | 0.5h | T10.1.1 | ✅ |
| T10.1.3 | CMakeLists.txt 链接 OSG/PROJ 库 | 1h | T10.1.2 | ✅ |

### S10.2 坐标系系统 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.2.1 | 创建 CoordinateSystem 类 | 1h | S10.1 | ✅ |
| T10.2.2 | 实现常用坐标系列表 (4326/4490/UTM) | 0.5h | T10.2.1 | ✅ |
| T10.2.3 | 实现 PROJ 坐标转换 | 1.5h | T10.2.2 | ✅ |
| T10.2.4 | 实现 EPSG 验证 | 0.5h | T10.2.3 | ✅ |

### S10.3 OSGB 导出核心 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.3.1 | 创建 OSGBExporter 类 | 1h | S10.2 | ✅ |
| T10.3.2 | MeshData → osg::Geometry 转换 | 2h | T10.3.1 | ✅ |
| T10.3.3 | 纹理绑定到 StateSet | 1h | T10.3.2 | ✅ |
| T10.3.4 | 写入 .osgb 文件 | 1h | T10.3.3 | ✅ |

### S10.4 LOD 生成 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.4.1 | osgUtil::Simplifier 网格简化 | 1.5h | S10.3 | ✅ |
| T10.4.2 | 创建 osg::LOD 节点 | 1h | T10.4.1 | ✅ |
| T10.4.3 | 生成 LOD 文件命名 (_L16_0 等) | 0.5h | T10.4.2 | ✅ |

### S10.5 标准目录结构 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.5.1 | 生成 Data/Tile_+XXX/ 目录结构 | 1h | S10.4 | ✅ |
| T10.5.2 | 生成 metadata.xml | 1h | T10.5.1 | ✅ |
| T10.5.3 | 纹理导出到瓦片目录 | 0.5h | T10.5.2 | ✅ |

### S10.6 导出对话框 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.6.1 | 创建 OSGBExportDialog 类 | 1h | S10.5 | ✅ |
| T10.6.2 | 模型选择列表 (QTreeWidget) | 1h | T10.6.1 | ✅ |
| T10.6.3 | 坐标系选择 (源/目标 EPSG) | 1h | T10.6.2 | ✅ |
| T10.6.4 | SRS Origin 设置 | 0.5h | T10.6.3 | ✅ |
| T10.6.5 | LOD 选项 (层数/简化比例) | 0.5h | T10.6.4 | ✅ |
| T10.6.6 | 输出目录选择 | 0.3h | T10.6.5 | ✅ |

### S10.7 MainWindow 集成 ✅
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T10.7.1 | File→Export OSGB 菜单项 | 0.3h | S10.6 | ✅ |
| T10.7.2 | 异步导出 (QtConcurrent) | 1h | T10.7.1 | ✅ |
| T10.7.3 | 进度显示 (QProgressDialog) | 0.5h | T10.7.2 | ✅ |
| T10.7.4 | 导出结果汇总 | 0.3h | T10.7.3 | ✅ |

**M10 总计: ~18h（已完成）**

> **2025-12-31 更新**: M10 OSGB 标准瓦片导出完成
> - **新增依赖**: osg (OpenSceneGraph), proj (PROJ 坐标转换库)
> - **CoordinateSystem**: PROJ 集成，支持 9000+ EPSG 坐标系
> - **OSGBExporter**: MeshData → osg::Geometry → .osgb
> - **LOD 生成**: osgUtil::Simplifier 简化 + osg::LOD 节点
> - **目录结构**: Data/Tile_+XXX_+YYY/ 标准倾斜摄影格式
> - **metadata.xml**: SRS/SRSOrigin 信息
> - **OSGBExportDialog**: 模型选择 + 坐标系 + LOD 配置
> - **快捷键**: Ctrl+Shift+G

### 新增文件

```
Apps/MoldWing/src/
├── IO/
│   ├── CoordinateSystem.hpp      # 坐标系定义和 PROJ 转换
│   ├── CoordinateSystem.cpp
│   ├── OSGBExporter.hpp          # OSGB 导出器
│   └── OSGBExporter.cpp
├── UI/
│   ├── OSGBExportDialog.hpp      # OSGB 导出对话框
│   └── OSGBExportDialog.cpp
```

### 常用坐标系

| EPSG | 名称 | 适用范围 |
|------|------|---------|
| 4326 | WGS84 | 全球（GPS 默认） |
| 4490 | CGCS2000 | 中国 2000 国家坐标系 |
| 4547 | CGCS2000 / 3° GK CM 114E | 中国东部 |
| 32650 | WGS84 / UTM zone 50N | 东亚 UTM |

---

## M11: 橡皮擦工具 ⏳ 0%

### S11.1 橡皮擦核心
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T11.1.1 | 创建 EraserTool 类（继承 TextureEditTool） | 0.5h | M7 | ⏳ |
| T11.1.2 | 保存原始纹理副本（用于恢复） | 0.5h | T11.1.1 | ⏳ |
| T11.1.3 | 实现橡皮擦绘制（恢复原始纹理） | 1.5h | T11.1.2 | ⏳ |
| T11.1.4 | 屏幕坐标→纹理坐标转换 | 0.5h | T11.1.3 | ⏳ |

### S11.2 橡皮擦优化
| ID | Task | 预计 | 依赖 | 状态 |
|----|------|------|------|------|
| T11.2.1 | 实现笔刷大小调节 | 0.5h | S11.1 | ⏳ |
| T11.2.2 | 实现笔刷硬度（边缘羽化） | 0.5h | T11.2.1 | ⏳ |
| T11.2.3 | 属性面板：笔刷大小滑块 | 0.3h | T11.2.2 | ⏳ |
| T11.2.4 | 快捷键 E 激活橡皮擦 | 0.2h | T11.2.3 | ⏳ |

**M11 总计: ~5h**

---

## M12: 颜色调整 ⏳ 0%

### S12.1 基础调整
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T12.1.1 | 实现 adjustBrightness() | 1h | M11 |
| T12.1.2 | 实现 adjustContrast() | 1h | T12.1.1 |
| T12.1.3 | 实现 adjustHueSaturation() | 1.5h | T12.1.2 |
| T12.1.4 | 创建 ColorAdjustCommand | 1h | T12.1.3 |

### S12.2 高级调整
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T12.2.1 | 实现 applyLevels() | 1.5h | S12.1 |
| T12.2.2 | 实现 applyCurves() | 2h | T12.2.1 |

### S12.3 调整UI
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T12.3.1 | 亮度/对比度滑块 | 0.5h | S12.2 |
| T12.3.2 | 色相/饱和度滑块 | 0.5h | T12.3.1 |
| T12.3.3 | 色阶直方图 | 1h | T12.3.2 |
| T12.3.4 | 曲线编辑器 | 2h | T12.3.3 |

**M12 总计: ~12h**

---

## M13: 几何修复 ⏳ 0%

### S13.1 CGAL 集成
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T13.1.1 | 配置 CGAL + Eigen3 | 1h | M5 |
| T13.1.2 | MeshData ↔ CGAL Surface_mesh 转换 | 2h | T13.1.1 |

### S13.2 孔洞检测与填充
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T13.2.1 | 实现 detectHoles() | 1h | S13.1 |
| T13.2.2 | 实现孔洞边缘高亮 | 1h | T13.2.1 |
| T13.2.3 | 实现 fillHole() | 2h | T13.2.2 |
| T13.2.4 | 实现 fillAllHoles() | 0.5h | T13.2.3 |
| T13.2.5 | 创建 FillHoleCommand | 1h | T13.2.4 |

### S13.3 网格清理
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T13.3.1 | 实现 analyzeMesh() | 1h | S13.1 |
| T13.3.2 | 实现非流形边修复 | 2h | T13.3.1 |
| T13.3.3 | 实现重复顶点合并 | 1h | T13.3.2 |
| T13.3.4 | 实现退化三角形删除 | 1h | T13.3.3 |

### S13.4 删除选中面
| ID | Task | 预计 | 依赖 |
|----|------|------|------|
| T13.4.1 | 实现 deleteSelectedFaces() | 1h | S13.3 |
| T13.4.2 | 创建 DeleteFacesCommand | 1h | T13.4.1 |

**M13 总计: ~16h**

---

## 任务统计

| 里程碑 | 预计工时 | 已完成 | 进度 |
|-------|---------|--------|------|
| M1 基础框架 | 44h | 44h | ✅ 100% |
| M2 框选 | 14h | 14h | ✅ 100% |
| M3 刷选 | 5h | 5h | ✅ 100% |
| M4 套索选择 | 5h | 5h | ✅ 100% |
| M5 连通选择 | 6h | 6h | ✅ 100% |
| M6 纹理渲染+编辑框架 | 22h | 22h | ✅ 100% |
| M7 克隆图章 | 9h | 9h | ✅ 100% |
| M7.5 OBJ带纹理导出 | 7h | 7h | ✅ 100% |
| M8 图层树与多模型管理 | 23h | 23h | ✅ 100% |
| M9 选择性导出 | 5h | 5h | ✅ 100% |
| M10 OSGB标准瓦片导出 | 18h | 18h | ✅ 100% |
| M11 橡皮擦 | 5h | 0h | ⏳ 0% |
| M12 颜色调整 | 12h | 0h | ⏳ 0% |
| M13 几何修复 | 16h | 0h | ⏳ 0% |
| **总计** | **~191h** | **~158h** | **~83%** |

---

## 下一步工作

M8/M9/M10 已全部完成。下一个待实现的功能：

| 里程碑 | 功能 | 优先级 |
|-------|------|--------|
| **M11** | 橡皮擦工具（恢复原始纹理） | 高 |
| M12 | 颜色调整（亮度/对比度/色相） | 中 |
| M13 | 几何修复（孔洞填充/非流形修复） | 低 |

---

**文档版本**: 6.0 (Qt 方案 - M8/M9/M10 完成)
**最后更新**: 2025-12-31
